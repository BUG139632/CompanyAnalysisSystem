# 财务报表与公告数据采集方法总结（2024最新版）

## 📊 当前主流程支持的数据源

### 1. 财务报表
- **巨潮资讯网（cninfo）**：API直连，结构化数据，自动保存为JSON，主流程已集成。
- **东方财富网（eastmoney）**：网页爬取，年报等数据，主流程已集成。
- **同花顺财经（thsl）**：网页爬取，结构化财报，主流程已集成。
- **深交所（szse）**：部分集成，数据有限。

### 2. 公司公告
- **东方财富网**：主流程已集成，支持PDF下载。
- **深交所**：主流程已集成。
- **巨潮资讯网**：公告采集暂未主推，主流程以财报为主。

### 3. 行业研报
- **东方财富网**：主流程已集成，支持PDF下载。

---

## 🚀 主流程采集方式

### 1. 统一入口
- 通过 `company_data_collector.py` 统一调度，输入公司名自动获取股票代码、行业分类。
- 自动调用各数据源采集财报、公告、行业研报。
- 采集结果按数据类型分别保存到 `output/financial_reports/`、`output/announcements/`、`output/industry_reports/`。

### 2. 采集与保存
- **巨潮API**：异步采集，自动保存每份报表为JSON。
- **网页型数据源**：Selenium/requests+解析，PDF自动下载，结构化数据保存为JSON。
- **行业研报**：自动识别PDF链接并下载。

### 3. 配置与扩展
- 所有数据源参数、headers、cookies等均在 `crawl4ai_config.yaml` 配置。
- 支持优先级、动态参数、保存目录自定义。

---

## 📝 典型用法

```bash
# 推荐用 run.sh 自动激活虚拟环境和PYTHONPATH
./run.sh main.py
```

或在Python代码中：

```python
from crawler_agent.company_data_collector import collect_single_company_data
collect_single_company_data('贵州茅台')
```

---

## 🗂️ 目录结构说明（核心部分）

- `company_data_collector.py`：主采集调度器
- `crawl4ai_agent_improved.py`：多源异步采集核心
- `data_source/`：各数据源采集实现
- `crawl4ai_config.yaml`：所有数据源和采集参数配置
- `output/`：所有采集结果输出目录

---

## ✅ 现有采集能力总结

| 数据类型   | 数据源         | 采集方式   | 主流程集成 | 结果保存         |
|------------|----------------|------------|------------|------------------|
| 财务报表   | 巨潮资讯网     | API        | ✅         | JSON/结构化      |
| 财务报表   | 东方财富网     | 网页+解析  | ✅         | JSON             |
| 财务报表   | 同花顺财经     | 网页+解析  | ✅         | JSON             |
| 公告       | 东方财富网     | 网页+解析  | ✅         | PDF/JSON         |
| 公告       | 深交所         | API        | ✅         | JSON             |
| 行业研报   | 东方财富网     | 网页+Selenium| ✅       | PDF              |

---

## 📝 注意事项

- 仅保留正式采集、配置和数据源实现文件，所有 example_*.py 和 sample_*.py 已移除。
- 采集结果不再生成汇总JSON，仅分类型保存。
- 配置文件和主流程均支持后续扩展和新数据源接入。

---

如需详细采集参数、配置说明或扩展建议，请参考 `crawl4ai_config.yaml` 或联系维护者。 